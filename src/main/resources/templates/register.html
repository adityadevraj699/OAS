<html th:replace="~{base::layout(~{::section})}">
  <head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </head>

  <body class="m-0 p-0" 
        style="background: linear-gradient(to right, #6a11cb, #2575fc); min-height:100vh; display:flex; align-items:center; justify-content:center;">
    
    <section class="w-100 d-flex justify-content-center align-items-center" 
             style="min-height:auto; padding:40px 0; background-color: rgba(135,206,250,0.1);">

      <div class="card shadow" style="max-width:700px; width:100%; padding:30px; border-radius:10px;">
        <h3 class="text-center mb-4">Register</h3>

        <form th:action="@{/register}" method="post" enctype="multipart/form-data" th:object="${student}">
          <div class="row g-3">
            <div class="col-md-6">
              <label for="rollNo" class="form-label">Roll Number</label>
              <input type="text" class="form-control" th:field="*{rollNo}" readonly placeholder="Roll Number" required>
            </div>

            <div class="col-md-6">
              <label for="name" class="form-label">Full Name</label>
              <input type="text" class="form-control" th:field="*{name}" readonly placeholder="Enter full name" required>
            </div>

            <div class="col-md-6">
              <label for="program" class="form-label">Program</label>
              <input type="text" class="form-control" th:field="*{program}" readonly placeholder="Enter program" required>
            </div>

            <div class="col-md-6">
              <label for="branch" class="form-label">Branch</label>
              <input type="text" class="form-control" th:field="*{branch}" readonly placeholder="Enter branch" required>
            </div>

            <!-- Gender and Year Row -->
            <div class="col-md-6">
              <label for="gender" class="form-label">Gender</label>
              <select class="form-select" th:field="*{gender}" required>
                <option value="" disabled>Select Gender</option>
                <option value="Male" th:selected="${student.gender == 'Male'}">Male</option>
                <option value="Female" th:selected="${student.gender == 'Female'}">Female</option>
                <option value="Other" th:selected="${student.gender == 'Other'}">Other</option>
              </select>
            </div>

            <div class="col-md-6">
              <label for="year" class="form-label">Year</label>
              <input type="text" class="form-control" th:field="*{year}" readonly>
            </div>

            <div class="col-md-6">
              <label for="email" class="form-label">Email</label>
              <input type="email" class="form-control" th:field="*{email}" readonly placeholder="Enter email" required>
            </div>

            <div class="col-md-6">
              <label for="contactNo" class="form-label">Mobile Number</label>
              <input type="tel" class="form-control" th:field="*{contactNo}" readonly pattern="[0-9]{10}" placeholder="Enter mobile number" required>
            </div>
          </div>

          <div class="row g-3 mt-2">
            <div class="col-md-6">
              <label for="fatherName" class="form-label">Father Name</label>
              <input type="text" class="form-control" th:field="*{fatherName}" placeholder="Enter father name">
            </div>

            <div class="col-md-6">
              <label for="motherName" class="form-label">Mother Name</label>
              <input type="text" class="form-control" th:field="*{motherName}" placeholder="Enter mother name">
            </div>
          </div>

          <div class="row g-3 mt-2">
            <div class="col-md-6">
              <label for="address" class="form-label">Address</label>
              <input type="text" class="form-control" th:field="*{address}" placeholder="Enter address">
            </div>

            <div class="col-md-6">
              <label for="utrNo" class="form-label">UTR Number</label>
              <input type="text" class="form-control" th:field="*{utrNo}" placeholder="Enter UTR number">
            </div>
          </div>

         <div class="row g-3 mt-2">
  <div class="col-md-12">
    <label for="paymentImage" class="form-label">Payment Image</label>
    <div class="d-flex align-items-start gap-3">
      <!-- Upload input -->
      <input type="file" class="form-control" name="paymentImage" id="paymentImage">

      <!-- Uploaded image preview -->
      <div th:if="${student.paymentImage != null}" class="d-flex flex-column align-items-center">
        <img th:src="${student.paymentImage}" alt="Uploaded Payment Image" style="max-width:150px; border-radius:5px; border:1px solid #ccc;">
      </div>

      <!-- Fixed image from Cloudinary -->
      <div class="d-flex flex-column align-items-center">
        <img src="https://res.cloudinary.com/ddtcj9ks5/image/upload/v1758720714/PAYMENT_IMAGE_gi21tz.png" 
             alt="Reference Payment Image" style="max-width:150px; border-radius:5px; border:1px solid #ccc;">
        <div style="margin-top:5px; background-color:#28a745; color:white; padding:5px 10px; border-radius:5px; font-weight:bold;">
          Total Payment: 45000
        </div>
      </div>
    </div>
  </div>
</div>


          <!-- Hidden fields for enums and date -->
          <input type="hidden" th:field="*{password}">
          <input type="hidden" th:value="${student.status.name()}" name="status">
          <input type="hidden" th:field="*{role}">
          <input type="hidden" th:field="*{regDate}">

          <button type="submit" class="btn w-100 text-white fw-bold mt-4" 
                  style="border-radius:20px; background: linear-gradient(to right, rgb(0,81,195), rgb(15,106,3));">
            Register
          </button>

          <div class="text-center mt-3">
            <small>Already registered? <a href="/login">Login here</a></small>
          </div>
        </form>
      </div>
      
      <input type="hidden" id="serverMessage" th:value="${msg}">
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const serverMessage = document.getElementById("serverMessage")?.value;

  if (serverMessage && serverMessage.trim() !== "") {
    // Lowercase version for easy keyword matching
    const lowerMsg = serverMessage.toLowerCase();

    // Determine if the message should be treated as an error
    const isError = lowerMsg.includes('invalid') || 
                    lowerMsg.includes('disabled') || 
                    lowerMsg.includes('not found') || 
                    lowerMsg.includes('wrong') || 
                    lowerMsg.includes('failed');

    Swal.fire({
      title: 'Notification',
      text: serverMessage,
      icon: isError ? 'error' : 'success',
      confirmButtonColor: '#2575fc',
      background: '#f9f9f9',
      color: '#333',
      timer: 4000,
      timerProgressBar: true
    });
  }
});
</script>
      
    </section>
  </body>
</html>
